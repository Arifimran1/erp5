<HTML>
  <HEAD>
    <meta http-equiv="content-type" content="text/html;charset=ISO-8859-1">
    <title tal:content="here/getTitle">Coramy</title>
    <link rel=stylesheet type="text/css" href="modele_catalog_c">
  </HEAD>

   <BODY bgcolor="#ffffff" tal:define="delivery_list python:here.object_action_list(selection_name='production_packing_list_selection',max_nb=10)">
<TABLE tal:repeat="delivery delivery_list" width="660" height="955"  cellpadding="0" cellspacing="0" class="PageA4">
  <TABLE width="660" height="900"  cellpadding="0" cellspacing="0"
          tal:define="fournisseur python:delivery.getSourceValue(portal_type=['Organisation','Category']);
                      livraison python:delivery.getDestinationValue(portal_type=
                      ['Organisation','Category']);
                      grand_total python:[0];
                      order_lines python:delivery.contentValues(filter={'portal_type':
                      'Production Packing List Line'});
                      order_lines_list python:delivery.sort_object_list(unordered_list=order_lines,sort_order = (('resource', 'ASC'),))"><!-- Tableau general -->
    <TR>
      <TD>
        <TABLE border="0" width="100%" height="100%">
          <TR>
            <TD valign="top">
              <h2>Coramy</h2>
            </TD>
            <TD align="center">
              <h2>Livraison fabrication n° <span tal:content="python:delivery.getId()"/></h2>
              <h2>OF n° <span tal:content="python:delivery.getDefaultCausalityId()"/></h2>
            </TD>
            <TD valign="top" align="right">
              <span tal:content="python:'Expédiée le : '+str(delivery.getStartDate())"/>
            </TD>
          </TR>
      </TD>
    </TR>

    <TR><!-- Espacement inter-tableaux -->
      <TD height="15"/>
    </TR>

    <TR height="10%"><!-- Infos -->
      <TD>
        <TABLE border="0" width="100%" height="100%">
          <TR>
            <TD nowrap class="bold">Expédié par </TD>
            <TD nowrap>
              <SPAN tal:condition="python:fournisseur<>None">
                <b><SPAN tal:content="python:modules['string'].capwords(fournisseur.getTitle())"/></b>
              </SPAN>
            </TD>
            <TD width="100%">&nbsp;</TD>
            <TD nowrap class="bold">Livrer à </TD>
            <TD nowrap>
              <SPAN tal:condition="python:livraison<>None">
                <b><SPAN tal:content="python:modules['string'].capwords(livraison.getTitle())"/></b>
                <br><SPAN tal:condition="python:livraison.getPortalType()<>'Category'">
                      <SPAN tal:define="address_items python:modules['string'].
                          split(livraison.getDefaultAddress().asText(country='France'),'\n')">
                        <SPAN tal:repeat="item address_items">
                          <SPAN tal:content="item"/><br>
                        </SPAN>
                      </SPAN>
                    </SPAN>
              </SPAN>
            </TD>
          </TR>

        </TABLE>
      </TD>
    </TR>


    <TR><!-- Espacement inter-tableaux -->
      <TD height="15"/>
    </TR>

    <TR><!-- Tableau de lignes de commande -->
      <TD valign="top">
        <TABLE border="2" width="100%">
          <TR>
            <TD class="bold" align="center">Code interne</TD>
            <TD class="bold" align="center">Type composant</TD>
            <TD class="bold" align="center">Fournisseur</TD>
            <TD class="bold" align="center" width="100%">Désignation</TD>
            <TD class="bold" align="center">Variantes</TD>
            <TD class="bold" align="center">Quantité</TD>
            <TD class="bold" align="center">Unité</TD>
          </TR>
          <SPAN tal:repeat="order_line order_lines_list">
            <SPAN tal:define="delivery_cell_list python:order_line.getDeliveryCellPrintList()">
              <TR tal:repeat="delivery_cell delivery_cell_list">
                <TD tal:content="python:delivery_cell[1]" align="left"></TD>
                <TD nowrap tal:content="python:delivery_cell[9]" align="left"></TD>
                <TD tal:content="python:delivery_cell[10]" align="left"></TD>
                <TD tal:content="python:delivery_cell[2]" align="left"></TD>
                <TD nowrap tal:define="variantes_list python:delivery_cell[3]" align="left">
                  <SPAN tal:repeat="variante variantes_list">
                    <SPAN tal:condition="python:variante<>'value' and variante<>None">
                      <SPAN tal:define="variante_items python:variante.split('/')">
                        <SPAN tal:content="python:variante_items[len(variante_items)-1]"/><BR>
                      </SPAN>
                    </SPAN>
                  </SPAN>
                </TD>
                <TD tal:content="python: '%.0f' % delivery_cell[4]" align="right"></TD>
                <TD tal:content="python:delivery_cell[5]" align="left"></TD>

              </TR>
            </SPAN>
          </SPAN>
  </TABLE>
  </TD>
    </TR>

      <TR tal:define="commentaires_list python:modules['string'].split(delivery.getComment(''),'\n')"><!-- Notes -->
       <TD valign="top">
          <span tal:repeat="commentaires_item commentaires_list">
          <br>
          <span tal:content="python:commentaires_item"/></span>
       </TD>
     </TR>

     <TR><!-- Espacement inter-tableaux -->
        <TD height="15"/>
      </TR>

     <TR>
        <TD height="90%"/>
      </TR>
      <TR>
        <TD align="center">Coramy - 5 bis, rue Denis Cordonnier - 59820 Gravelines (FRANCE)<br>Tél. : + 33 (0) 3 28 51 91 51 -  Fax : + 33 (0) 3 28 23 34 96
        <p class="Copy">S.A.S. au capital de 435.200 € - T.V.A. FR 67 611 750 274 - R.C. Dunkerque 611 750 274 - SIRET 611 750 274 00023  - CNUF 15971</p>
        </TD>
      </TR>
    </TABLE>
</TABLE>
  </BODY>
</HTML>
