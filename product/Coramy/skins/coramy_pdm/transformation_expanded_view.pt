<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "DTD/xhtml1-strict.dtd">
<?xml-stylesheet  href="erp5.css" rel="stylesheet" type="text/css"?>

<span tal:replace="nothing">
<!--
Copyright (c) 2002 Nexedi SARL and Contributors. All Rights Reserved.
                   Jean-Paul Smets <jp@nexedi.com>

This program is Free Software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
-->
</span>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en"
    xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    metal:use-macro="here/main_template/macros/master">

  <head>
      <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
      <title tal:content="template/title_or_id">The title</title>
      <link href="erp5.css" rel="stylesheet" type="text/css"/>
  </head>

  <body><div metal:fill-slot="main">
          <div class="Main">

<span tal:repeat="reference_taille python:here.getExpandedViewVariationList(request,'reference_taille_list')">
 <span tal:repeat="reference_coloris python:here.getExpandedViewVariationList(request,'reference_coloris_list')">
  <span tal:repeat="reference_morphologie python:here.getExpandedViewVariationList(request,'reference_morphologie_list')">
    Détail de la transformation <strong><span tal:replace="reference_coloris"/></strong>
   - taille <strong><span tal:replace="reference_taille"/></strong>
   - morphologie <strong><span tal:replace="reference_morphologie"/></strong><br><br>
    <font size="-2">

    <table border="1">
      <tr>
        <th>
          Transformation
        </th>
        <th>
          Composant/Opération
        </th>
        <th>
          Description
        </th>
        <th>
          Quantité saisie
        </th>
        <th>
          Unité saisie
        </th>
        <th>
          Quantité convertie
        </th>
        <th>
          Unité composant
        </th>
        <th>
          Prix unitaire
        </th>
        <th>
          Temps
        </th>
        <th>
          Efficience
        </th>
        <th>
          Prix total
        </th>
        <th>
          Origine prix
        </th>
        <th>
          Origine quantité
        </th>
        <th>
          Origine variante
        </th>
        <th>
          Erreurs
        </th>
      </tr>
      <span tal:define="test_request python:here.expandedViewRequestBuilder(
                        reference_taille=reference_taille,
                        reference_coloris=reference_coloris,
                        reference_morphologie=reference_morphologie);
                        summary python:here.getAggregatedAmountList(REQUEST=test_request);
                        grand_total_base_price python:'%.3f' % summary[1];
                        grand_total_source_base_price python:'%.3f' % summary[2];
                        grand_total_duration python:'%.3f' % summary[3];
                        grand_total_duration_france python:'%.3f' % summary[4]">
      <tr tal:repeat="amount python:summary[0]">
        <td tal:content="amount/transformation_id">
          The Id of this transformation
        </td>
        <td>
          <span tal:replace="amount/resource_relative_url">The url of this resource</span>
          <i tal:condition="amount/pretty_variation" tal:content="structure amount/pretty_variation">
          </i>
        </td>
        <td tal:content="amount/description">
          The resource name
        </td>
        <td tal:content="python: '%.3f' % amount['quantity']">
          The resource quantity
        </td>
        <td tal:content="amount/quantity_unit">
          The item unit
        </td>
        <td tal:content="python: '%.3f' % amount['converted_quantity']">
          The resource unit
        </td>
        <td tal:content="amount/resource_quantity_unit | string:">
          The resource unit
        </td>
        <td tal:content="python: '%.3f' % amount['unit_base_price']">
          The resource price
        </td>
        <td tal:content="python: '%.3f' % amount['duration']">
          The resource duration
        </td>
        <td tal:content="python: '%.3f' % amount['efficiency']">
          The resource efficiency
        </td>
        <td tal:content="python: '%.3f' % amount['total_base_price']" >
          The resource total price
        </td>
        <td tal:content="amount/base_price_defined_by">
          The price origin
        </td>
        <td tal:content="amount/quantity_defined_by">
          The quantity origin
        </td>
        <td tal:content="amount/variation_defined_by">
          The quantity origin
        </td>
        <td>
          <span tal:condition="amount/error_list | nothing"
                tal:replace="amount/error_list" />
        </td>
      </tr>
      <tr>
        <th colspan="8" align="right">
          Total
        </th>
        <th>
          <span tal:replace="grand_total_duration">Total Duration</span><br>
          <i><span tal:replace="grand_total_duration_france">Total Duration for France</span></i>
        </th>
        <th>
        </th>
        <th colspan="4" tal:content="grand_total_base_price" align="left">
          Total Price
        </th>

      </tr>
      </span>
    </table>

    </font>
    <br>
  </span>
 </span>
</span>
          </div>
      </div>
  </body>
</html>
