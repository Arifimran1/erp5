# varnish - a web accelerator written with performance and flexibility in mind.
# http://www.varnish-cache.org/

[buildout]
parts =
  varnish
  varnish-2.1

extends =
  ../software-profiles/pcre.cfg
  ../software-profiles/patch.cfg

[varnish]
<= varnish-2.0

[varnish-2.0]
recipe = hexagonit.recipe.cmmi
url = http://sourceforge.net/projects/varnish/files/varnish/2.0.6/varnish-2.0.6.tar.gz/download
md5sum = d91dc21c636db61c69b5e8f061c5bb95

# http://www.varnish-cache.org/trac/ticket/801
[varnish-2.1.4-r5467-patch]
recipe = hexagonit.recipe.download
url = http://www.varnish-cache.org/trac/changeset/5467?format=diff&new=5467
md5sum = 04a0696239658c87d6acac32f356608e
filename = changeset_r5467.diff
download-only = true

[varnish-2.1]
recipe = hexagonit.recipe.cmmi
url = http://www.varnish-software.com/sites/default/files/varnish-2.1.4.tar.gz
md5sum = e794a37b6fbb786a083c0946103ae103
patch-options = -p4
configure-options =
  --with-pcre-config=${pcre:location}/bin
patches =
  ${varnish-2.1.4-r5467-patch:location}/${varnish-2.1.4-r5467-patch:filename}
environment =
  PATH=${patch:location}/bin:%(PATH)s
  LDFLAGS=-Wl,-rpath -Wl,${pcre:location}/lib
