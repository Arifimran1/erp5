<?xml version="1.0"?>
<ZopeData>
  <record id="1" aka="AAAAAAAAAAE=">
    <pickle>
      <global name="File" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>_EtagSupport__etag</string> </key>
            <value> <string>ts41268128.68</string> </value>
        </item>
        <item>
            <key> <string>__name__</string> </key>
            <value> <string>image.js</string> </value>
        </item>
        <item>
            <key> <string>content_type</string> </key>
            <value> <string>application/javascript</string> </value>
        </item>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

(function() {\n
\tmodule("tinymce.plugins.Image", {\n
\t\tsetupModule: function() {\n
\t\t\tQUnit.stop();\n
\n
\t\t\ttinymce.init({\n
\t\t\t\tselector: \'textarea\',\n
\t\t\t\tadd_unload_trigger: false,\n
\t\t\t\tskin: false,\n
\t\t\t\tplugins: "image",\n
\t\t\t\tdisable_nodechange: true,\n
\t\t\t\tinit_instance_callback: function(ed) {\n
\t\t\t\t\twindow.editor = ed;\n
\t\t\t\t\tQUnit.start();\n
\t\t\t\t}\n
\t\t\t});\n
\t\t},\n
\n
\t\tteardown: function() {\n
\t\t\tdelete editor.settings.image_dimensions;\n
\t\t\tdelete editor.settings.file_browser_callback;\n
\t\t\tdelete editor.settings.image_list;\n
\t\t\tdelete editor.settings.image_class_list;\n
\t\t\tdelete editor.settings.document_base_url;\n
\t\t\tdelete editor.settings.image_advtab;\n
\n
\t\t\tvar win = Utils.getFrontmostWindow();\n
\n
\t\t\tif (win) {\n
\t\t\t\twin.close();\n
\t\t\t}\n
\t\t}\n
\t});\n
\n
\tfunction cleanHtml(html) {\n
\t\treturn Utils.cleanHtml(html).replace(/<p>(&nbsp;|<br[^>]+>)<\\/p>$/, \'\');\n
\t}\n
\n
\tfunction fillAndSubmitWindowForm(data) {\n
\t\tvar win = Utils.getFrontmostWindow();\n
\n
\t\twin.fromJSON(data);\n
\t\twin.find(\'form\')[0].submit();\n
\t\twin.close();\n
\t}\n
\n
\ttest(\'Default image dialog on empty editor\', function() {\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"constrain": true,\n
\t\t\t"height": "",\n
\t\t\t"src": "",\n
\t\t\t"width": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"height": "100",\n
\t\t\t"src": "src",\n
\t\t\t"width": "200"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img src="src" alt="alt" width="200" height="100" /></p>\'\n
\t\t);\n
\t});\n
\n
\ttest(\'Image dialog image_dimensions: false\', function() {\n
\t\teditor.settings.image_dimensions = false;\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"src": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"src": "src"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img src="src" alt="alt" /></p>\'\n
\t\t);\n
\t});\n
\n
\ttest(\'All image dialog ui options on empty editor\', function() {\n
\t\teditor.settings.image_list = [\n
\t\t\t{title: \'link1\', value: \'link1\'},\n
\t\t\t{title: \'link2\', value: \'link2\'}\n
\t\t];\n
\n
\t\teditor.settings.image_class_list = [\n
\t\t\t{title: \'class1\', value: \'class1\'},\n
\t\t\t{title: \'class2\', value: \'class2\'}\n
\t\t];\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"class": "class1",\n
\t\t\t"constrain": true,\n
\t\t\t"height": "",\n
\t\t\t"src": "",\n
\t\t\t"width": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"class": "class1",\n
\t\t\t"constrain": true,\n
\t\t\t"height": "200",\n
\t\t\t"src": "src",\n
\t\t\t"width": "100"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img class="class1" src="src" alt="alt" width="100" height="200" /></p>\'\n
\t\t);\n
\t});\n
\n
\ttest("Image recognizes relative src url and prepends relative image_prepend_url setting.", function () {\n
\t\tvar win, elementId, element;\n
\n
\t\teditor.settings.image_prepend_url = \'testing/images/\';\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tvar data = {\n
\t\t\t"src": "src",\n
\t\t\t"alt": "alt"\n
\t\t};\n
\n
\t\twin = Utils.getFrontmostWindow();\n
\t\telementId = win.find(\'#src\')[0]._id;\n
\t\telement = document.getElementById(elementId).childNodes[0];\n
\n
\t\twin.fromJSON(data);\n
\t\tUtils.triggerElementChange(element);\n
\n
\t\twin.find(\'form\')[0].submit();\n
\t\twin.close();\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img src="\' + editor.settings.image_prepend_url + \'src" alt="alt" /></p>\'\n
\t\t);\n
\n
\n
 \t});\n
\n
 \ttest("Image recognizes relative src url and prepends absolute image_prepend_url setting.", function () {\n
\t\tvar win, elementId, element;\n
\n
\t\teditor.settings.image_prepend_url = \'http://testing.com/images/\';\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tvar data = {\n
\t\t\t"src": "src",\n
\t\t\t"alt": "alt"\n
\t\t};\n
\n
\t\twin = Utils.getFrontmostWindow();\n
\t\telementId = win.find(\'#src\')[0]._id;\n
\t\telement = document.getElementById(elementId).childNodes[0];\n
\n
\t\twin.fromJSON(data);\n
\t\tUtils.triggerElementChange(element);\n
\n
\t\twin.find(\'form\')[0].submit();\n
\t\twin.close();\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img src="\' + editor.settings.image_prepend_url + \'src" alt="alt" /></p>\'\n
\t\t);\n
 \t});\n
\n
\ttest(\'Advanced image dialog border option on empty editor\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"border": "10px",\n
\t\t\t"src": "src"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img style="border-width: 10px;" src="src" alt="alt" /></p>\'\n
\t\t);\n
\t});\n
\n
\ttest(\'Advanced image dialog margin space options on empty editor\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"hspace": "10",\n
\t\t\t"src": "src",\n
\t\t\t"vspace": "10"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img style="margin: 10px;" src="src" alt="alt" /></p>\'\n
\t\t);\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog border style only options on empty editor\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"src": "src",\n
\t\t\t"style": "border-width: 10px;"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img style="border-width: 10px;" src="src" alt="alt" /></p>\'\n
\t\t);\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog margin style only options on empty editor\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"src": "src",\n
\t\t\t"style": "margin: 10px;"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img style="margin: 10px;" src="src" alt="alt" /></p>\'\n
\t\t);\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog overriden border style options on empty editor\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"border": "10",\n
\t\t\t"src": "src",\n
\t\t\t"style": "border-width: 15px;",\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img style="border-width: 10px;" src="src" alt="alt" /></p>\'\n
\t\t);\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog overriden margin style options on empty editor\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tfillAndSubmitWindowForm({\n
\t\t\t"alt": "alt",\n
\t\t\t"hspace": "10",\n
\t\t\t"src": "src",\n
\t\t\t"style": "margin-left: 15px; margin-top: 20px;",\n
\t\t\t"vspace": "10"\n
\t\t});\n
\n
\t\tequal(\n
\t\t\tcleanHtml(editor.getContent()),\n
\t\t\t\'<p><img style="margin: 10px;" src="src" alt="alt" /></p>\'\n
\t\t);\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog non-shorthand horizontal margin style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin-left: 15px; margin-right: 15px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "15",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin-left: 15px; margin-right: 15px;",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog non-shorthand vertical margin style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin-top: 15px; margin-bottom: 15px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin-top: 15px; margin-bottom: 15px;",\n
\t\t\t"vspace": "15"\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog shorthand margin 1 value style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin: 5px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "5",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin: 5px;",\n
\t\t\t"vspace": "5"\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog shorthand margin 2 value style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin: 5px 10px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "10",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin: 5px 10px 5px 10px;",\n
\t\t\t"vspace": "5"\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog shorthand margin 2 value style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin: 5px 10px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "10",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin: 5px 10px 5px 10px;",\n
\t\t\t"vspace": "5"\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog shorthand margin 3 value style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin: 5px 10px 15px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "10",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin: 5px 10px 15px 10px;",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog shorthand margin 4 value style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin: 5px 10px 15px 20px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin: 5px 10px 15px 20px;",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t});\n
\n
\ttest(\'Advanced image dialog shorthand margin 4 value style change test\', function(){\n
\t\teditor.settings.image_advtab = true;\n
\t\teditor.settings.image_dimensions = false;\n
\n
\t\teditor.setContent(\'\');\n
\t\teditor.execCommand(\'mceImage\', true);\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "",\n
\t\t\t"vspace": ""\n
\t\t});\n
\n
\t\tUtils.getFrontmostWindow().find(\'#style\').value(\'margin: 5px 10px 15px 20px; margin-top: 15px;\').fire(\'change\');\n
\n
\t\tdeepEqual(Utils.getFrontmostWindow().toJSON(), {\n
\t\t\t"alt": "",\n
\t\t\t"border": "",\n
\t\t\t"hspace": "",\n
\t\t\t"src": "",\n
\t\t\t"style": "margin: 15px 10px 15px 20px;",\n
\t\t\t"vspace": "15"\n
\t\t});\n
\n
\t});\n
})();\n


]]></string> </value>
        </item>
        <item>
            <key> <string>precondition</string> </key>
            <value> <string></string> </value>
        </item>
        <item>
            <key> <string>size</string> </key>
            <value> <int>13243</int> </value>
        </item>
        <item>
            <key> <string>title</string> </key>
            <value> <string>image.js</string> </value>
        </item>
      </dictionary>
    </pickle>
  </record>
</ZopeData>
