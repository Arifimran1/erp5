<?xml version="1.0"?>
<ZopeData>
  <record id="1" aka="AAAAAAAAAAE=">
    <pickle>
      <global name="PythonScript" module="Products.PythonScripts.PythonScript"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>Script_magic</string> </key>
            <value> <int>3</int> </value>
        </item>
        <item>
            <key> <string>_bind_names</string> </key>
            <value>
              <object>
                <klass>
                  <global name="NameAssignments" module="Shared.DC.Scripts.Bindings"/>
                </klass>
                <tuple/>
                <state>
                  <dictionary>
                    <item>
                        <key> <string>_asgns</string> </key>
                        <value>
                          <dictionary>
                            <item>
                                <key> <string>name_container</string> </key>
                                <value> <string>container</string> </value>
                            </item>
                            <item>
                                <key> <string>name_context</string> </key>
                                <value> <string>context</string> </value>
                            </item>
                            <item>
                                <key> <string>name_m_self</string> </key>
                                <value> <string>script</string> </value>
                            </item>
                            <item>
                                <key> <string>name_subpath</string> </key>
                                <value> <string>traverse_subpath</string> </value>
                            </item>
                          </dictionary>
                        </value>
                    </item>
                  </dictionary>
                </state>
              </object>
            </value>
        </item>
        <item>
            <key> <string>_body</string> </key>
            <value> <string encoding="cdata"><![CDATA[

from json import dumps\n
\n
absolute_url = "%s" % context.absolute_url()\n
\n
return """\n
\n
var slide_total_pages=1\n
var slide_current_page=""\n
\n
function goToNewSlide(relative_path){\n
  slide_current_page=relative_path;\n
  $.ajax({\n
    url: %(absolute_url)s+"/"+relative_path,\n
    type: \'get\',\n
    async: false,\n
    success: function(data) {\n
      $(\'#slide_content\').html(data);\n
    } \n
  });\n
  renderNavigation();\n
  resetPageSelector();\n
}\n
\n
function resetNavigation(name,id_a,id_img,class_default,class_hide){\n
  $nav_default=$("a:contains(\'"+name+"\')")\n
  if($nav_default.length>0){\n
    $nav_default.addClass("hidden");\n
    $("#"+id_a).attr("onclick","goToNewSlide(\'"+$nav_default.attr("href")+"\')");\n
    $("#"+id_a).css("cursor","pointer")\n
    $("#"+id_img).attr("class",class_default);\n
  }\n
  else\n
  {\n
    //remove the string without tag\n
    $("#slide_content").html($("#slide_content").html().replace(name, ""));\n
    $("#"+id_a).attr("onclick","");\n
    $("#"+id_a).css("cursor","default")\n
    $("#"+id_img).attr("class",class_hide);\n
  }\n
}\n
\n
function renderNavigation(){\n
  resetNavigation("First page","first_slide","first_slide_img","first","first shaded");\n
  resetNavigation("Back","previous_slide","previous_slide_img","previous","previous shaded");\n
  resetNavigation("Continue","next_slide","next_slide_img","next","next shaded");\n
  resetNavigation("Last page","last_slide","last_slide_img","last","last shaded");\n
  resetNavigation("Text","text_slide","text_slide_img","text","text hidden");\n
  resetNavigation("Graphics","graphics_slide","graphics_slide_img","graphics","graphics hidden");\n
}\n
\n
function resetPageSelector(){\n
  $("#slides_total_number").text(slide_total_pages);\n
  $("#slide_selection_index").keyup(function(event) {\n
    if (event.keyCode==13) {\n
      redirectPresentationPage()\n
    }\n
  });\n
  if(slide_current_page.indexOf("text")==-1){\n
    if(parseInt(slide_current_page.replace(".html","").replace("img","")))\n
      $("#slide_selection_index").val(parseInt(slide_current_page.replace(".html","").replace("img",""))+1);\n
    else\n
      $("#slide_selection_index").val(1);\n
  }\n
  else\n
    if(parseInt(slide_current_page.replace(".html","").replace("text","")))\n
      $("#slide_selection_index").val(parseInt(slide_current_page.replace(".html","").replace("text",""))+1);\n
    else\n
      $("#slide_selection_index").val(1);\n
}\n
\n
function redirectPresentationPage(){\n
  //Graphic pages\n
  if(slide_current_page.indexOf("text")==-1){\n
    if(slide_total_pages!=1)\n
      {\n
      //if entered number bigger than total number, go to last page, else incorrect number go to first page\n
      if( $("#slide_selection_index").val()>1 && $("#slide_selection_index").val()<slide_total_pages){\n
        real_page_number=$("#slide_selection_index").val()-1;\n
        goToNewSlide("img"+real_page_number+".html");\n
      }\n
      else if($("#slide_selection_index").val()>=slide_total_pages){\n
        real_page_number=slide_total_pages-1\n
        goToNewSlide("img"+real_page_number+".html");\n
      }\n
      else{\n
        goToNewSlide("asPresentationHTML");\n
      }\n
    }\n
    else\n
      goToNewSlide("asPresentationHTML");\n
  }\n
  //Text pages\n
  else{\n
    //if entered number bigger than total number, go to last page, else incorrect number go to first page\n
    if( $("#slide_selection_index").val()>1 && $("#slide_selection_index").val()<slide_total_pages){\n
      real_page_number=$("#slide_selection_index").val()-1;\n
      goToNewSlide("text"+real_page_number+".html");\n
    }\n
    else if($("#slide_selection_index").val()>=slide_total_pages){\n
      real_page_number=slide_total_pages-1\n
      goToNewSlide("text"+real_page_number+".html");\n
    }\n
    else{\n
      goToNewSlide("text0.html");\n
    }\n
  }  \n
}\n
\n
function preventEnterKeyInGlobal(){\n
  $(function(){\n
    var keyStop = {\n
      13: "input:text", // stop enter = submit \n
      end: null\n
    };\n
    $(document).bind("keydown", function(event){\n
     var selector = keyStop[event.which];\n
     if(selector !== undefined && $(event.target).is(selector)) {\n
       event.preventDefault(); //stop event\n
     }\n
     return true;\n
    });\n
  });\n
}\n
\n
$(document).ready(function() {\n
  goToNewSlide("asPresentationHTML");\n
  var last_page_href=$("a:contains(\'Last page\')").attr("href");\n
  if(last_page_href)\n
    slide_total_pages=parseInt(last_page_href.replace(".html","").replace("img",""))+1;\n
  else\n
    slide_total_pages=1;\n
  resetPageSelector();\n
  preventEnterKeyInGlobal();\n
});\n
\n
""" % dict(\n
  absolute_url = dumps(absolute_url)\n
)\n


]]></string> </value>
        </item>
        <item>
            <key> <string>_params</string> </key>
            <value> <string></string> </value>
        </item>
        <item>
            <key> <string>id</string> </key>
            <value> <string>Presentation_renderSlidePage</string> </value>
        </item>
      </dictionary>
    </pickle>
  </record>
</ZopeData>
